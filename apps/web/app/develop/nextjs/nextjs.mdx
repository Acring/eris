# 在 Nextjs 中使用 Eris UI

## 使用

### 安装

将下面的脚本保存到项目的 `scripts/eris-upgrade.js` 中，并在 `package.json` 中配置对应的快捷启动脚本

yarn 1.x

```javascript
const pathname = 'http://eris-ui.xsky.com';
const http = require('http');
const { exec } = require('child_process');

http
  .get(`${pathname}/api/version/latest`, (resp) => {
    let data = '';

    // 接收数据片段。
    resp.on('data', (chunk) => {
      data += chunk;
    });

    // 数据接收完毕。
    resp.on('end', () => {
      const { ui, uiPreset, icons } = JSON.parse(data);
      console.log(`当前版本：ui: ${ui}\nui-preset: ${uiPreset}\nicons: ${icons}`);

      exec(
        `
        yarn upgrade git+ssh://git@github.xsky.com/front-end/eris.git#eris-icons-v${icons}-gitpkg
        yarn upgrade git+ssh://git@github.xsky.com/front-end/eris.git#eris-ui-v${ui}-gitpkg
        yarn upgrade git+ssh://git@github.xsky.com/front-end/eris.git#eris-ui-preset-v${uiPreset}-gitpkg
        `,
        (error, stdout, stderr) => {
          if (error) {
            console.error(`执行错误: ${error}`);
            return;
          }
          console.log(stdout);
        },
      );
    });
  })
  .on('error', (err) => {
    console.error('请求错误: ' + err.message);
  });

```

yarn 2+

```javascript
const pathname = 'http://eris-ui.xsky.com';
const http = require('http');
const { exec } = require('child_process');

http
  .get(`${pathname}/api/version/latest`, (resp) => {
    let data = '';

    // 接收数据片段。
    resp.on('data', (chunk) => {
      data += chunk;
    });

    // 数据接收完毕。
    resp.on('end', () => {
      const { ui, uiPreset, icons } = JSON.parse(data);
      console.log(`当前版本：ui: ${ui}\nui-preset: ${uiPreset}\nicons: ${icons}`);

      exec(
        `
        yarn up @xsky/eris-icons@git+ssh://git@github.xsky.com/front-end/eris.git#eris-icons-v${icons}-gitpkg
        yarn up @xsky/eris-ui@git+ssh://git@github.xsky.com/front-end/eris.git#eris-ui-v${ui}-gitpkg
        yarn up @xsky/eris-ui-preset@git+ssh://git@github.xsky.com/front-end/eris.git#eris-ui-preset-v${uiPreset}-gitpkg
        `,
        (error, stdout, stderr) => {
          if (error) {
            console.error(`执行错误: ${error}`);
            return;
          }
          console.log(stdout);
        }
      );
    });
  })
  .on('error', (err) => {
    console.error('请求错误: ' + err.message);
  });
```

package.json

```JSON
    "eris:upgrade": "node ./scripts/eris-upgrade.js"
```

然后执行

```bash
yarn eris:upgrade
```

### 修改 tailwind.config.ts

1. 在 config.content 中增加 `'./node_modules/@xsky/eris-ui/**/*.{js,ts,jsx,tsx,mdx}'`
2. 设置 config.presets

```ts
{
  presets: [require('@xsky/eris-ui-preset')];
}
```

### 配置 next.config.js 
- transpilePackages (包转译)，解决 assets 引入图片问题
- optimizePackageImports (包优化)

```ts
/** @type {import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: true,
  transpilePackages: ['@xsky/eris-ui'],
  experimental: {
    optimizePackageImports: ['@xsky/eris-ui'],
  },
```

### 使用组件

```ts
import { Button, Input } from '@xsky/eris-ui';
```

